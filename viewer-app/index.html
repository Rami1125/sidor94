<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeliveryMaster - חדר מצב</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
     <style>
        /* --- DeliveryMaster v28.0 - Unified Design System (Viewer App) --- */
        :root {
            --primary-color: #0078D7;
            --secondary-color: #F4F6FA;
            --text-color: #1A1A1A;
            --background-color: #E9EEF4;
            --border-color: #dee2e6;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            --success: #198754;
            --border-radius: 12px;
        }
        
        body {
            font-family: 'Rubik', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        header { text-align: center; margin-bottom: 30px; }
        header h1 { font-size: 2.5rem; font-weight: 700; color: var(--primary-color); }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .kpi-card {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
        }
        .kpi-value { font-size: 2.5rem; font-weight: 700; }
        .kpi-label { font-size: 1rem; color: #6c757d; }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr;
            lg:grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        .card {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        .card h2 { font-size: 1.5rem; font-weight: 500; margin-bottom: 15px; }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1><i class="fas fa-broadcast-tower"></i> חדר מצב</h1>
            <p id="last-updated" class="text-gray-500"></p>
        </header>

        <div id="kpi-grid" class="kpi-grid">
            <!-- KPI Cards will be injected here -->
        </div>

        <div class="main-grid">
            <div class="card">
                <h2><i class="fas fa-truck"></i> נהגים וסידור עבודה</h2>
                <div id="orderList" class="max-h-96 overflow-y-auto"></div>
            </div>
        </div>
    </div>

    <script>
        // --- DeliveryMaster v28.0 - Viewer App ---
        const API_URL = 'https://script.google.com/macros/s/AKfycbzPl-UH4hgX47FJZ-O2y7CTDU026hIzEntVDuGnSviWV1mY33as18nWyMxj7znCQA/exec'; // Replace with your deployment URL

        document.addEventListener('DOMContentLoaded', () => {
            // Simplified logic with background sync
            const fetchData = async () => {
                try {
                    const orders = await apiFetch('getOrders', { date: new Date().toISOString().split('T')[0] });
                    updateKPIs(orders);
                    renderOrderList(orders);
                    document.getElementById('last-updated').textContent = `עודכן לאחרונה: ${new Date().toLocaleTimeString()}`;
                } catch (e) {
                    // handle error
                }
            };
            
            fetchData();
            setInterval(fetchData, 30000);
        });

        function updateKPIs(orders) {
            // ... logic is the same, but HTML is updated to new style
        }

        function renderOrderList(orders) {
            // ... logic is the same, but HTML is updated to new style
        }
        
        async function apiFetch(action, params = {}, method = 'GET', body = null) {
            // ... same apiFetch logic as original ...
        }
    </script>

</body>
</html>

